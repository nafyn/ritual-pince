<!DOCTYPE html>
<html lang="fr">
<style>
  .content-block {
  flex: 1;                /* occupe tout l’espace vertical restant */
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  gap: 0.3rem;            /* espace propre entre titre/summary/effort */
}
</style>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pince's contributions</title>
  <meta name="description" content="my small public contributions portal" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            base: {
              bg: '#0b0f0e',
              soft: '#0e1311',
              surface: '#111614',
              card: '#141a1e',
              border: 'rgba(255,255,255,0.06)',
              text: '#d6e2dc',
              sub: '#9fb3ab'
            },
            acc: '#40ffaf', // vert demandé
          },
          boxShadow: {
            glow: '0 0 0 3px rgba(64,255,175,0.15) inset'
          },
          borderRadius: {
            xxl: '1.25rem'
          }
        }
      }
    }
  </script>
  <style>
    body{background: radial-gradient(1200px 600px at 10% -10%, rgba(64,255,175,.08), transparent),
                     radial-gradient(900px 500px at 90% -20%, rgba(64,255,175,.06), transparent),
                     #0b0f0e;}
    ::selection{background:#40ffaf;color:#001b0b}
    /* subtle grain */
  body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='200' height='200' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E") repeat;
    z-index: -1;
  }
  /* scrollbar styling */
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 999px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(64,255,175,0.25); }
  html { scrollbar-width: thin; scrollbar-color: rgba(255,255,255,0.08) transparent; }
  /* refined minimal scrollbar */
  * {
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.08) transparent;
  }
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.08);
    border-radius: 999px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: rgba(64,255,175,0.35);
  }
  /* Hide scrollbar completely */
  * {
    scrollbar-width: none;
  }
  *::-webkit-scrollbar {
    display: none;
  }

  /* Emerald halo on page edge */
  body::after {
    content: "";
    position: fixed;
    top: 0;
    right: 0;
    width: 2px;
    height: 100vh;
    background: linear-gradient(to bottom, rgba(64,255,175,0.45), rgba(64,255,175,0.05));
    pointer-events: none;
    opacity: 0.55;
    mix-blend-mode: screen;
  }
</style>
</head>
<body class="min-h-screen text-base-text">
  <!-- Top bar -->
  <header class="sticky top-0 z-10 backdrop-blur border-b border-base-border/50" style="background: rgba(10,14,12,0.6)">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
      <span class="inline-flex items-center gap-2 font-semibold text-base-text">
        <span class="size-3 rounded-full" style="background:#40ffaf"></span>
        Ritual Contributions
      </span>
      
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6 space-y-4">
    <!-- Profile card -->
    <section class="rounded-xxl p-5 border border-base-border/20 bg-base-surface/70 backdrop-blur-sm">
      <div class="flex items-start gap-4">
        <img id="pfAvatar" src="assets/my-mlg-edit.jpg" class="size-16 rounded-full ring-2" style="--tw-ring-color:#40ffaf" alt="avatar"/>
        <div class="flex-1">
          <h1 id="pfName" class="text-2xl font-bold">Pince Croco</h1>
          <p id="pfBio" class="text-sm text-base-sub mt-1">just a ritty community member</p>
          <p id="pfBio" class="text-sm text-base-sub mt-1">⁺‧₊˚ ཐི⋆♱⋆ཋྀ ˚₊‧⁺‧</p>
          <div class="flex flex-wrap gap-2 mt-3 text-sm">
            <a href="https://x.com/pince_croco" class="flex items-center gap-2 px-4 py-1 rounded-full border border-base-border/20 text-base-text/80 hover:text-acc hover:bg-base-surface/40 transition-colors"target="_blank" rel="noopener noreferrer">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="pointer-events-none">
                <path d="M18.146 2H21.5L14.355 10.027L22.5 22H15.75L10.58 14.742L4.73 22H1.366L9.08 13.34L1 2H7.93L12.62 8.659L18.146 2ZM16.926 19.98H18.89L7.04 4H4.94L16.926 19.98Z" fill="currentColor"/>
              </svg></a>
            
            <a id="pfDiscord" class="flex items-center gap-2 px-4 py-1 rounded-full border border-acc/30 text-acc bg-acc/10 cursor-default">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36" class="w-5 h-5 fill-current">
            <path d="M107.7,8.07A105.15,105.15,0,0,0,81.73,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,48.76,6.83,72.37,72.37,0,0,0,45.4,0,105.89,105.89,0,0,0,19.44,8.09C2.82,32.65-1.71,56.6.54,80c12.7,9.39,24.89,15.08,36.84,18.93A77.7,77.7,0,0,0,47.6,87.12a68.42,68.42,0,0,1-10.84-5.26c.91-.66,1.8-1.37,2.66-2.08a75.57,75.57,0,0,0,48.29,0c.87.71,1.76,1.42,2.66,2.08A68.68,68.68,0,0,1,79.53,87.1a77.18,77.18,0,0,0,10.28,11.85c11.94-3.86,24.13-9.54,36.84-18.93C128.85,56.6,124.32,32.65,107.7,8.07ZM42.71,65.69c-7.06,0-12.82-6.3-12.82-14s5.66-14,12.82-14S55.53,43,55.53,51.72,49.77,65.69,42.71,65.69Zm41.72,0c-7.06,0-12.82-6.3-12.82-14s5.65-14,12.82-14,12.82,6.3,12.82,14S91.49,65.69,84.43,65.69Z"/>
            </svg>
            <span>pince_croco</span></a>
          </div>
          <p id="stats" class="text-sm text-acc mt-3"></p>
        </div>
      </div>
    </section>

    <!-- Search + filters -->
    <section class="rounded-xxl p-5 border border-base-border/20 bg-base-surface/70 backdrop-blur-sm">
      <div class="flex flex-wrap items-center gap-3">
        <div class="flex-1">
          <div class="px-3 py-2 rounded-lg border border-base-border/20 w-full bg-white/5 backdrop-blur-sm">
            <input id="q" placeholder="Search title or tags…" class="w-full bg-transparent outline-none" />
          </div>
        </div>
        <div id="chips" class="flex flex-wrap items-center gap-2"></div>
        <div>
          <div id="sortChips" class="flex items-center gap-2">
            <button data-sort="Newest" class="px-3 py-1.5 rounded-full border text-sm">Newest</button>
            <button data-sort="Oldest" class="px-3 py-1.5 rounded-full border text-sm">Oldest</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Grid -->
    <section id="grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6"></section>
  </main>

  <footer class="border-t border-base-border/20">
    <div class="max-w-6xl mx-auto px-4 py-5 text-sm text-base-sub flex items-center justify-between">
      <a href="https://x.com/elatysatnaf" class="hover:text-acc transition" target="_blank" rel="noopener noreferrer"> inspired by Fantasytale Portal</a>
      <span>this user is virtually lost in permanent delusion</span>
    </div>
  </footer>

  <template id="cardTpl">
  <article class="relative rounded-2xl border p-4 bg-base-card border-base-border/30
    flex flex-col justify-between
    transition-all duration-200 hover:shadow-glow hover:border-acc/50 hover:-translate-y-1 hover:scale-[1.015]"
    draggable="true">
    <div class="flex items-start justify-between">
      <span class="text-xs px-2 py-1 rounded-full border border-base-border/20 c-cat">cat</span>
      <div class="mt-3 text-xs text-base-sub"><span class="c-date">--/--/----</span></div>
    </div>
    <div class="content-block">
      <h3 class="mt-3 text-base font-semibold c-title">Title</h3>
      <p class="text-sm mt-1 text-base-sub c-summary">Summary</p>
      <p class="eff text-xs mt-1 text-base-sub c-eff"></p>
    </div>
    <div class="mt-4 flex items-center gap-2">
      <a class="c-link inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-acc/60 text-acc hover:shadow-glow" target="_blank" rel="noreferrer">open link →</a>
      <span class="c-soon hidden text-xs px-2 py-1 rounded-lg" style="background:rgba(64,255,175,0.1);color:#40ffaf">Soon</span>
    </div>
    <div class="absolute inset-0 rounded-2xl pointer-events-none" style="box-shadow:inset 0 0 0 1px rgba(64,255,175,0.04)"></div>
  </article>
</template>

  <script>
    const TABS = ["All","Thread","Art","Meme","Event","Community","Tech"];
    let state = { items: [], profile: {}, tab: 'All', q: '', sortKey: 'Newest' };

    const grid = document.getElementById('grid');
    const tpl = document.getElementById('cardTpl');
    const chips = document.getElementById('chips');
    const q = document.getElementById('q');
    const sortChips = document.getElementById('sortChips');

    // Build chips
    TABS.forEach(t=>{
      const b = document.createElement('button');
      b.textContent = t;
      b.className = 'px-3 py-1.5 rounded-full border text-sm';
      b.style.borderColor = 'rgba(255,255,255,0.06)';
      b.addEventListener('click', ()=>{ state.tab=t; render(); });
      chips.appendChild(b);
    });

    function styleActiveChips(){
      // category chips
      [...chips.children].forEach(ch=>{
        const on = ch.textContent===state.tab;
        ch.style.borderColor = on? '#40ffaf' : 'rgba(255,255,255,0.06)';
        ch.style.color      = on? '#40ffaf' : '';
        ch.style.boxShadow  = on? '0 0 0 3px rgba(64,255,175,0.15) inset' : 'none';
        ch.style.background = on? 'rgba(64,255,175,0.08)' : 'transparent';
      });
      // sort chips
      if (sortChips) {
        sortChips.querySelectorAll('button').forEach(btn=>{
          const on = btn.dataset.sort===state.sortKey;
          btn.style.borderColor = on? '#40ffaf' : 'rgba(255,255,255,0.06)';
          btn.style.color      = on? '#40ffaf' : '';
          btn.style.boxShadow  = on? '0 0 0 3px rgba(64,255,175,0.15) inset' : 'none';
          btn.style.background = on? 'rgba(64,255,175,0.08)' : 'transparent';
        })
      }
    }

    q.addEventListener('input', ()=>{ state.q=q.value; render(); });
    // sort chips events
    sortChips.querySelectorAll('button').forEach(btn=>{
      btn.style.borderColor = 'rgba(255,255,255,0.06)';
      btn.addEventListener('click',()=>{ state.sortKey = btn.dataset.sort; render(); });
    });

    function mapToPublic(it){
    return {
      title: it.title,
      desc: it.summary,
  
      // cover auto si pas d'image custom
      cover: it.cover || 'https://picsum.photos/seed/' + encodeURIComponent(it.title) + '/1200/675',
  
      url: it.link || '',
      status: it.link ? 'live' : 'soon',
  
      kind: (it.category || '').toLowerCase(),
      category: it.category || 'Tech',
  
      effort: it.effort || null,
      date: it.date || null,
  
      createdAt: it.createdAt
    };
  }

    function updateStats() {
      const statsEl = document.getElementById("stats");
      if (!statsEl) return;
    
      const items = state.items || [];
      const contributions = items.length;
    
      // On convertit les efforts en heures si possible
      let totalHours = 0;
    
      items.forEach(it => {
        if (!it.effort) return;
    
        let str = it.effort.trim().toLowerCase();
    
        // ex: "2h" → 2h
        if (str.endsWith("h")) {
          totalHours += parseFloat(str);
          return;
        }
    
        // ex: "30min" → 0.5h
        if (str.includes("min")) {
          const mins = parseFloat(str);
          totalHours += (mins / 60);
          return;
        }
    
        // ex: "2j" → 48h
        if (str.endsWith("j")) {
          totalHours += parseFloat(str) * 24;
          return;
        }
      });
    
      // On arrondit gentiment
      totalHours = Math.round(totalHours * 10) / 10;
    
      statsEl.textContent = `gave ~${totalHours}h through ${contributions} contributions`;
    }

    function render(){
      styleActiveChips();
      let items = state.items.map(mapToPublic);
      if(state.tab!=='All') items = items.filter(x=>x.category===state.tab);
      if(state.q.trim()){
        const s=state.q.trim().toLowerCase();
        items = items.filter(x=> (x.title||'').toLowerCase().includes(s) || (x.desc||'').toLowerCase().includes(s) || (x.kind||'').includes(s));
      }
      
      items.sort((a, b) => {
        const da = new Date(a.date || a.createdAt);
        const db = new Date(b.date || b.createdAt);
      
        return state.sortKey === 'Newest'
          ? db - da
          : da - db;
      });

      grid.innerHTML='';
      if(items.length===0){
        grid.innerHTML = '<div class="rounded-2xl p-5 border border-base-border/20 bg-base-surface/70 backdrop-blur-sm text-base-sub">No items.</div>';
        return;
      }
      items.forEach(p=>{
        const n = tpl.content.cloneNode(true);
        n.querySelector('.c-cat').textContent = p.category;
        n.querySelector('.c-date').textContent = p.date
           ? new Date(p.date).toLocaleDateString()
           : new Date(p.createdAt || Date.now()).toLocaleDateString();
        n.querySelector('.c-title').textContent = p.title;
        n.querySelector('.c-summary').textContent = p.desc || '';
        n.querySelector('.c-eff').textContent = p.effort ? `effort ~ ${p.effort}` : '';
        
        const btn = n.querySelector('.c-link');
        const soon = n.querySelector('.c-soon');
        if(p.url){ btn.href=p.url; } else { btn.classList.add('hidden'); soon.classList.remove('hidden'); }
        grid.appendChild(n);
      })

      // JSON debug
      document.getElementById('json').textContent = JSON.stringify({profile: state.profile, items: state.items}, null, 2);
    }
    

    function hydrateProfile(p){
      if(!p) return;
      if(p.avatar) document.getElementById('pfAvatar').src = p.avatar;
      if(p.name) document.getElementById('pfName').textContent = p.name;
      if(p.bio) document.getElementById('pfBio').textContent = p.bio;
      if(p.x){ const a=document.getElementById('pfX'); a.href = p.x.startsWith('http')? p.x : 'https://x.com/'+p.x.replace('@',''); }
      if(p.github){ const a=document.getElementById('pfGit'); a.href = p.github.startsWith('http')? p.github : 'https://github.com/'+p.github; }
    }

    async function boot(){
      // 1) essaie de charger contributions.json
      try{
        const r = await fetch('contributions.json',{cache:'no-store'});
        if(r.ok){
          const data = await r.json();
          state.items = Array.isArray(data.items)? data.items : [];
          state.profile = data.profile||{};
          hydrateProfile(state.profile);
          render();
          updateStats();
          return;
        }
      }catch(_){/* ignore */}

      // 2) fallback de démo si pas de JSON
      state.profile = { name: 'Pince Croco', bio: 'just a ritty community member', x: 'ritty', github: 'ritty' };
      hydrateProfile(state.profile);
      render();
    }

    const yEl = document.getElementById('year'); if (yEl) { yEl.textContent = new Date().getFullYear(); }
    boot();
  </script>
</body>
</html>
